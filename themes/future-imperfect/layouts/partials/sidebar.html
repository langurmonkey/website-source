<!-- Sidebar -->
<section id="sidebar">

    <!-- Intro -->
    <section id="intro">
        {{ $pic := .Site.Params.intro.pic }}
        {{ with $pic.src }}
        {{ if $pic.circle }}
        <a href="/" class="mainlogo"><img src="{{ . }}" class="intro-circle" width="{{ $pic.width }}" alt="{{ $pic.alt }}" /></a>
        {{ else if $pic.imperfect }}
        <a href="/" class="logo"><img src="{{ . }}" alt="{{ $pic.alt }}" /></a>
        {{ else }}
        <a href="/" class="mainlogo"><img src="{{ . }}" width="{{ $pic.width }}" alt="{{ $pic.alt }}" /></a>
        {{ end }}
        {{ end }}
        {{ with .Site.Params.intro }}
        <header>
            <h2><a href="/">{{ .header }}</a></h2>
            <p>{{ .paragraph | safeHTML }}</p>
        </header>
        {{ end }}
        <ul class="icons">
            {{ if .Site.Params.socialAppearAtTop }}
            {{ partial "social" . }}
            {{ end }}
        </ul>
    </section>

    <!-- About -->
    {{ with .Site.Params.intro.about }}
    <section class="blurb">
        <header>
            <h3><a href="/about">About</a></h3>
        </header>
        <p>{{ . }}</p>
    </section>
    {{ end }}
    
    <!-- Links -->
    <section id="links">
        <ul class="sidebar-links">
            <li><a href="/about" class="button">/about</a></li>
            <li><a href="/categories" class="button">/categories</a></li>
            <li><a href="/tags" class="button">/tags</a></li>
        </ul>
    </section>

    <!-- Posts List -->
    <section class="recent-posts">
        <div class="mini-posts">
            <header>
                <h3>Latest Posts</h3>
            </header>
            <div class="posts-container">
                {{ $.Scratch.Set "recentPosts" .Site.Pages }}

                {{ $.Scratch.Set "postLimit" 8 }}

                    {{ range first ($.Scratch.Get "postLimit") (where ($.Scratch.Get "recentPosts") "Type" "post") }}
                    <div class="recent-posts-item">
                        <a href="{{ .RelPermalink }}">{{ .Title | truncate 30 }}</a>&nbsp;
                        {{ $.Scratch.Set "dateType" .Date }}
                        <time class="published" datetime='{{ ($.Scratch.Get "dateType").Format "2006-01-02" }}'>
                           [ {{ ($.Scratch.Get "dateType").Format "January 2, 2006" }} ]
                        </time>
                    </div>
                    {{ end }}
            </div>

            {{ if ge (len (where .Site.Pages "Type" "post")) ($.Scratch.Get "postLimit") }}
            <a href="/posts-list" class="button" style="margin-top: 2em;">View all posts</a>
            {{ end }}
        </div>
    </section>

    <!-- Footer -->
    <section id="footer">
        <ul class="icons">
            {{ if .Site.Params.socialAppearAtBottom }}
            {{ partial "social" . }}
            {{ end }}
        </ul>

        <p class="copyright">&copy; {{ .Site.Title }}. All rights reserved.</p>
    </section>

</section>
